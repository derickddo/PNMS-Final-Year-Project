{% load custom_filters %}

{% if needs %}
<div class="">
    <div class="needs-assessment">
        <h3 class="font-bold md:text-xl text-lg">{{ sector|title }} Sector</h3>
        <p class="mt-2 text-gray-600 dark:text-white">Recently created need assessments</p>

        <div class="grid grid-cols-1 md:grid-cols-1 mt-4">
            {% if facility_needs %}
            <div class="facility_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ facility_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Facility needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-lg">Facility Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 mt-2">This is a facility needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>
                    
                    
                    

                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#facility_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ facility_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span class="font-medium">
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in facility_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ facility_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ facility_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in facility_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#facility_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ facility_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ facility_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Facility Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Facility</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in facility_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Facility: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if facility_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            {% if personnel_needs %}
            <div class="personnel_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ personnel_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Personnel needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Personnel Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a personnel needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>

                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#personnel_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ personnel_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in personnel_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ personnel_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ personnel_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in personnel_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#personnel_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ personnel_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ personnel_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Personnel Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Personnel</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in personnel_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Personnel: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if personnel_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!--water_needs-->
            {% if water_needs %}
            <div class="water_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ water_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Water needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Water Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a water needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>

                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#water_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ water_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in water_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ water_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ water_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in water_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#water_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ water_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ water_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Water Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Water Source</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in water_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Water Source: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if water_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            {% if skip_container_needs %}
            <div class="skip_container_needs mb-8">
                <h3 class="font-bold text-lg md:text-xl mt-4">{{ skip_container_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Skip container needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Skip container Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a skip container needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>

                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#skip_container_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ skip_container_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in skip_container_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ skip_container_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ skip_container_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in skip_container_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#skip_container_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ skip_container_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ skip_container_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Skip Container Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Skip Container</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in skip_container_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Skip Container: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if skip_container_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!--classroom_needs-->
            {% if classroom_needs %}
            <div class="classroom_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ classroom_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Classroom needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Classroom Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a classroom needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>
                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#classroom_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ classroom_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in classroom_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ classroom_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ classroom_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in classroom_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#classroom_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ classroom_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ classroom_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Classroom Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Classroom</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in classroom_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Classroom: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if classroom_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!--dual_desk_needs-->
            {% if dual_desk_needs %}
            <div class="dual_desk_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ dual_desk_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Dual desk needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Dual desk Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a dual desk needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>
                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#dual_desk_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ dual_desk_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in dual_desk_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ dual_desk_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ dual_desk_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in dual_desk_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#dual_desk_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ dual_desk_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ dual_desk_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Dual Desk Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Dual desk</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in dual_desk_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Dual desk: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if dual_desk_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!--toilet_needs-->
            {% if toilet_needs %}
            <div class="toilet_needs mb-8">
                <h3 class="font-bold md:text-xl text-lg mt-4">{{ toilet_needs.0.needs_type|title }} Needs Assessment</h3>
                <p class="mt-2 text-gray-600 dark:text-white">Toilet type needs assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</p>

                <div class="card card-bordered p-5 rounded-md mt-4 relative shadow-lg">
                    <!-- Edit and Delete buttons -->
                    <h3 class="font-bold md:text-xl">Toilet type Needs Assessment for {{ needs_assessment.population_projection.content_object.name }} {{ needs_assessment.population_projection.area_type|title }}</h3>
                    <p class="text-gray-600 dark:text-white">This is a toilet type needs assessment for {{ needs_assessment.population_projection.content_object }} {{ needs_assessment.population_projection.area_type|title }}. It shows the needs of health facilities in the area.</p>

                    <span class="block md:hidden mt-2">
                        <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#toilet_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                            <i class="fas fa-eye text-blue-500 mr-2"></i>
                            View More
                        </a>
                    </span>

                    <div class="dropdown dropdown-end absolute right-3 top-3">
                        <div tabindex="0" role="button" class="m-1 py-1 px-2 hover:bg-base-300 rounded-md cursor-pointer">
                            <i class="fa-solid fa-ellipsis-h"></i>
                        </div>
                        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li>
                                <a href="{% url 'update_needs_assessment_page' needs_assessment.slug %}?needs_type={{ toilet_needs.0.needs_type }}" hx-trigger="click" hx-target="#main" hx-push-url="true" class="editBtn text-blue-500 hover:text-blue-700">Edit</a>
                            </li>
                            <li>
                                <a class="deleteBtn text-red-500 hover:text-red-700">Delete</a>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-4">
                        <!-- Dropdown Toggle Button for Small Screens -->
                        <div class="dropdown dropdown-end md:hidden w-full">
                            <label tabindex="0" class="btn btn-sm btn-outline w-full text-left py-2 px-4 bg-gray-200 hover:bg-gray-300 hover:text-black rounded-md">
                                <i class="fas fa-chevron-down mr-2"></i> Details
                            </label>
                            <ul tabindex="0" class="dropdown-content menu p-4 shadow-md bg-white rounded-md mt-2 w-full z-50">
                                <!-- Categories of Needs -->
                                <li class="">

                                    <div class="mt-2">
                                        <span>
                                            <i class="fas fa-tags  mr-2 text-red-500"></i>
                                            Categories:
                                        </span>
                                        {% for needs_type in toilet_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </li>
                    
                                <!-- Area Name -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Name: {{ needs_assessment.population_projection.content_object.name }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Area Type -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                        Area Type: {{ needs_assessment.population_projection.area_type|title }}
                                    </span>
                                    
                                </li>
                    
                                <!-- Projected Population -->
                                <li class="mb-2">
                                    <span class="font-medium">
                                        <i class="fas fa-users text-green-500 mr-2"></i>
                                        Projected Population: {{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}
                                    </span>
                                 
                                </li>
                    
                                <!-- Total Number of Needs -->
                                <li>
                                    <span class="font-medium">
                                        <i class="fas fa-list text-yellow-500 mr-2"></i>
                                        Total Needs: {{ toilet_needs|length }}
                                    </span>
                                    
                                </li>
                            </ul>
                        </div>
                    
                        <!-- Non-Dropdown Content for Larger Screens -->
                        <div class="hidden md:flex md:justify-between">
                            <div>
                                <!-- Categories of needs -->
                                <div class="flex items-center">
                                    <span class="font-medium">
                                        <i class="fas fa-tags text-gray-500 mr-2"></i>
                                        Categories of {{ toilet_needs.0.needs_type }}:
                                    </span>
                                    <div class="ml-2">
                                        {% for needs_type in toilet_needs|get_distinct_needs_type_from_needs %}
                                            <span class="badge badge-primary badge-md">{{ needs_type }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                    
                                <div class="flex gap-8 mb-2 mt-2">
                                    <!-- Area Name -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Name:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.content_object.name }}</span>
                                    </div>
                    
                                    <!-- Area Type -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                                            Area Type:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.population_projection.area_type }}</span>
                                    </div>
                                </div>
                    
                                <span>
                                    <a href="" hx-get="{% url 'manage_need_assessment' needs_assessment.slug %}#toilet_needs" hx-push-url="true" hx-target="#main" hx-swap="innerHTML" class="link link-primary hover:underline">
                                        <i class="fas fa-eye text-blue-500 mr-2"></i>
                                        View Details
                                    </a>
                                </span>
                            </div>
                    
                            <div>
                                <div class="flex justify-between mb-4">
                                    <!-- Type of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-tag text-yellow-500 mr-2"></i>
                                            Type:
                                        </span>
                                        <span class="ml-2">{{ toilet_needs.0.needs_type }}</span>
                                    </div>
                                    <!-- Year of need -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-calendar text-gray-500 mr-2"></i>
                                            Year:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.year }} - {{ needs_assessment.population_projection.projections.all.last.projecting_year }}</span>
                                    </div>
                                </div>
                    
                                <div class="flex justify-between gap-4">
                                    <!-- Projected Population -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-users text-green-500 mr-2"></i>
                                            Projected Population:
                                        </span>
                                        <span class="ml-2">{{ needs_assessment.needs.all.0.content_object.population|floatformat:"0" }}</span>
                                    </div>
                    
                                    <!-- Total Number of Needs -->
                                    <div class="flex items-center">
                                        <span class="font-medium">
                                            <i class="fas fa-list text-gray-500 mr-2"></i>
                                            Total Needs:
                                        </span>
                                        <span class="ml-2">{{ toilet_needs|length }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    

                    <!-- Table to show needs in needs_assessment -->
                    <div class="overflow-x-auto mt-4">
                        <h2 class="md:text-lg font-bold mb-1">Toilet Type Needs Table</h2>
                        <p class="text-gray-700 text-sm">A table showing the needs of health facilities in the area.</p>
                        <table class="table w-full mt-4">
                            <thead>
                                <tr>
                                    <th>Toilet Type</th>
                                    <th>Year</th>
                                    <th>Population</th>
                                    <th>Standard Threshold</th>
                                    <th>No. Available</th>
                                    <th>Required</th>
                                    <th>New Need</th>
                                    <th>Surplus</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for need in toilet_needs %}
                                <tr class="relative group {% if forloop.counter > 5 %}hidden{% endif %} need-row">
                                    <td class="p-2">{{ need.content_object.type_name }}</td>
                                    <td class="p-2">{{ need.content_object.year }}</td>
                                    <td class="p-2">{{ need.content_object.population|floatformat:"0" }}</td>
                                    <td class="p-2">{{ need.content_object.standard }}</td>
                                    <td class="p-2">{{ need.content_object.available }}</td>
                                    <td class="p-2">{{ need.content_object.required }}</td>
                                    <td class="p-2">{% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</td>
                                    <td class="p-2">{% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</td>

                                    <!-- Dropdown for small screens -->
                                    <td class="absolute top-0 right-0 p-2 hidden group-hover:block md:hidden bg-white shadow-lg rounded-md">
                                        <select class="block w-full border border-gray-300 rounded-md">
                                            <option>Toilet Type: {{ need.content_object.type_name }}</option>
                                            <option>Year: {{ need.content_object.year }}</option>
                                            <option>Population: {{ need.content_object.population|floatformat:"0" }}</option>
                                            <option>Standard Threshold: {{ need.content_object.standard }}</option>
                                            <option>No. Available: {{ need.content_object.available }}</option>
                                            <option>Required: {{ need.content_object.required }}</option>
                                            <option>New Need: {% if need.content_object.new_need is None %} -{% else %} {{ need.content_object.new_need }} {% endif %}</option>
                                            <option>Surplus: {% if need.content_object.suplus is None %} -{% else %} {{ need.content_object.suplus }} {% endif %}</option>
                                        </select>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if toilet_needs|length > 5 %}
                    <div class="mt-4 flex justify-center">
                        <button class="btn btn-sm btn-primary view-more-less">View More</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}





        </div>
        <input id="hidden" type="hidden" name="" value="{{ needs_assessment_slug }}">
    </div>
{% else %}
<div class="mt-8 h-[20rem] flex justify-center items-center">
    <span class="text-gray-600 dark:text-white">
        <i class="fas fa-exclamation-triangle text-red-500 text-2xl"></i>
        <span class="ml-2">No needs assessment found for this sector</span>
    </span>
</div>
{% endif %}
